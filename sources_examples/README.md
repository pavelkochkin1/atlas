# Sources Examples

## Описание проекта

**Sources Examples** — это мокап-сервисс, предназначенный для управления и предоставления информации о различных источниках данных. Сервис включает в себя документацию по данным, скрипты ETL для обработки данных и API для доступа к этим ресурсам. Основными компонентами сервиса являются:

- **Confluence**: Документация по витринам данных.
- **GitLab**: Скрипты ETL для обработки и интеграции данных.
- **FastAPI Сервис**: Веб-сервис для поиска и доступа к документации и скриптам ETL.
- **Docker**: Контейнеризация приложения для упрощенного развертывания.

## Структура проекта

```
atlas/sources_examples/
├── Dockerfile
├── README.md
├── confluence/
│   ├── GoldenRecord/
│   │   ├── cp_users_doc.md
│   │   └── pml_data_doc.md
│   ├── KION/
│   │   ├── kion_film_views_doc.md
│   │   └── kion_users_doc.md
│   └── Stroki/
│       ├── stroki_readings_doc.md
│       └── stroki_users_doc.md
├── default_data.txt
├── gitlab/
│   ├── GoldenRecord/
│   │   ├── cp_users_spark.py
│   │   └── pml_data_spark.py
│   ├── KION/
│   │   ├── kion_film_views_spark.py
│   │   └── kion_users_spark.py
│   └── Stroki/
│       ├── stroki_readings_spark.py
│       └── stroki_users_spark.py
├── main.py
├── mts_schema.txt
├── requirements.txt
└── utils.py
```

## Установка

### Требования

- **Docker**: Убедитесь, что Docker установлен на вашей системе. Если нет, скачайте и установите его с [официального сайта Docker](https://www.docker.com/get-started).

### Шаги по установке

1. **Клонирование репозитория**

   Клонируйте репозиторий проекта на локальную машину:

   ```bash
   git clone <URL_репозитория>
   cd atlas/sources_examples
   ```

2. **Сборка Docker образа**

   Используйте предоставленный `Dockerfile` для сборки Docker образа:

   ```bash
   docker build -t sources-examples:latest .
   ```

## Запуск проекта

После успешной сборки Docker образа, запустите контейнер следующим образом:

```bash
docker run -d -p 8043:8043 --name sources-examples sources-examples:latest
```

Приложение будет доступно по адресу `http://localhost:8043`.

## Использование

### API Эндпоинты

Проект предоставляет следующие API эндпоинты для взаимодействия:

1. **Получение схемы данных**

   - **URL:** `/schema`
   - **Метод:** `GET`
   - **Описание:** Возвращает список таблиц из файла `mts_schema.txt`.

   **Пример запроса:**

   ```bash
   curl http://localhost:8043/schema
   ```

2. **Поиск в Confluence**

   - **URL:** `/confluence`
   - **Метод:** `GET`
   - **Параметры:**
     - `table` (строка, обязательный): Название таблицы или витрины для поиска.
   - **Описание:** Ищет файлы внутри папки `confluence` и её поддиректорий. Если `table` содержится в имени файла или в содержимом файла, возвращает содержимое этого файла.

   **Пример запроса:**

   ```bash
   curl "http://localhost:8043/confluence?table=GoldenRecord"
   ```

3. **Поиск в GitLab**

   - **URL:** `/gitlab`
   - **Метод:** `GET`
   - **Параметры:**
     - `table` (строка, обязательный): Название таблицы или витрины для поиска.
   - **Описание:** Ищет файлы внутри папки `gitlab` и её поддиректорий. Если `table` содержится в имени файла или в содержимом файла, возвращает текст кода Spark из этого файла.

   **Пример запроса:**

   ```bash
   curl "http://localhost:8043/gitlab?table=KION"
   ```

### Документация по данным

Документация по различным витринам данных находится в папке `confluence` и включает информацию о структуре данных, источниках, назначении и ответственных лицах.

### Скрипты ETL

Скрипты обработки данных расположены в папке `gitlab` в соответствующих поддиректориях для каждого источника данных. Эти скрипты используют Apache Spark для обработки и трансформации данных.
